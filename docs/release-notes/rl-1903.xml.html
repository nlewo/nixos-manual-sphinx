
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Release 19.03 (“Koi”, 2019/04/11) &#8212; NixOS Manual  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="release-19-03-koi-2019-04-11">
<span id="sec-release-19-03"></span><h1>Release 19.03 (“Koi”, 2019/04/11)<a class="headerlink" href="#release-19-03-koi-2019-04-11" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="highlights">
<span id="sec-release-19-03-highlights"></span><h1>Highlights<a class="headerlink" href="#highlights" title="Permalink to this headline">¶</a></h1>
<p>In addition to numerous new and upgraded packages, this release has the
following highlights:</p>
<ul>
<li><p class="first">End of support is planned for end of October 2019, handing over to 19.09.</p>
</li>
<li><p class="first">The default Python 3 interpreter is now CPython 3.7 instead of CPython
3.6.</p>
</li>
<li><p class="first">Added the Pantheon desktop environment. It can be enabled through
<code class="docutils literal notranslate"><span class="pre">services.xserver.desktopManager.pantheon.enable</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">services.xserver.desktopManager.pantheon</span></code>
enables LightDM as a display manager, as pantheon’s screen locking
implementation relies on it.</p>
<p class="last">Because of that it is recommended to leave LightDM enabled. If you’d like
to disable it anyway, set
to
<code class="docutils literal notranslate"><span class="pre">false</span></code> and enable your preferred display manager.</p>
</div>
<p>Also note that Pantheon’s LightDM greeter is not enabled by default,
because it has numerous issues in NixOS and isn’t optimal for use here
yet.</p>
</li>
<li><p class="first">A major refactoring of the Kubernetes module has been completed.
Refactorings primarily focus on decoupling components and enhancing
security. Two-way TLS and RBAC has been enabled by default for all
components, which slightly changes the way the module is configured. See:
<a class="reference internal" href="../configuration/kubernetes.xml.html#sec-kubernetes"><span class="std std-ref">Kubernetes</span></a> for details.</p>
</li>
<li><p class="first">There is now a set of options for
, which allows to restrict services
into a
chroot
2
ed environment that only contains the store paths from
the runtime closure of the service.</p>
</li>
</ul>
</div>
<div class="section" id="new-services">
<span id="sec-release-19-03-new-services"></span><h1>New Services<a class="headerlink" href="#new-services" title="Permalink to this headline">¶</a></h1>
<p>The following new services were added since the last release:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">./programs/nm-applet.nix</span></code></li>
<li>There is a new <code class="docutils literal notranslate"><span class="pre">security.googleOsLogin</span></code> module for using
<a class="reference external" href="https://cloud.google.com/compute/docs/instances/managing-instance-access">OS
Login</a> to manage SSH access to Google Compute Engine instances,
which supersedes the imperative and broken
<code class="docutils literal notranslate"><span class="pre">google-accounts-daemon</span></code> used in
<code class="docutils literal notranslate"><span class="pre">nixos/modules/virtualisation/google-compute-config.nix</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">./services/misc/beanstalkd.nix</span></code></li>
<li>There is a new <code class="docutils literal notranslate"><span class="pre">services.cockroachdb</span></code> module for running
CockroachDB databases. NixOS now ships with CockroachDB 2.1.x as well,
available on <code class="docutils literal notranslate"><span class="pre">x86_64-linux</span></code> and
<code class="docutils literal notranslate"><span class="pre">aarch64-linux</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">./security/duosec.nix</span></code></li>
<li>The <a class="reference external" href="https://duo.com/docs/duounix">PAM module for Duo
Security</a> has been enabled for use. One can configure it using the
options along with the corresponding PAM
option in
.</li>
</ul>
</div>
<div class="section" id="backward-incompatibilities">
<span id="sec-release-19-03-incompatibilities"></span><h1>Backward Incompatibilities<a class="headerlink" href="#backward-incompatibilities" title="Permalink to this headline">¶</a></h1>
<p>When upgrading from a previous release, please be aware of the following
incompatible changes:</p>
<ul>
<li><p class="first">The minimum version of Nix required to evaluate Nixpkgs is now 2.0.</p>
<ul>
<li><p class="first">For users of NixOS 18.03 and 19.03, NixOS defaults to Nix 2.0, but
supports using Nix 1.11 by setting <code class="docutils literal notranslate"><span class="pre">nix.package</span> <span class="pre">=</span>
<span class="pre">pkgs.nix1;</span></code>. If this option is set to a Nix 1.11 package, you
will need to either unset the option or upgrade it to Nix 2.0.</p>
</li>
<li><p class="first">For users of NixOS 17.09, you will first need to upgrade Nix by setting
<code class="docutils literal notranslate"><span class="pre">nix.package</span> <span class="pre">=</span> <span class="pre">pkgs.nixStable2;</span></code> and run
<strong class="command">nixos-rebuild switch</strong> as the <code class="docutils literal notranslate"><span class="pre">root</span></code>
user.</p>
</li>
<li><p class="first">For users of a daemon-less Nix installation on Linux or macOS, you can
upgrade Nix by running <strong class="command">curl https://nixos.org/nix/install |
sh</strong>, or prior to doing a channel update, running
<strong class="command">nix-env -iA nix</strong>.</p>
<p>If you have already run a channel update and Nix is no longer able to
evaluate Nixpkgs, the error message printed should provide adequate
directions for upgrading Nix.</p>
</li>
<li><p class="first">For users of the Nix daemon on macOS, you can upgrade Nix by running
<strong class="command">sudo -i sh -c 'nix-channel --update &amp;&amp; nix-env -iA
nixpkgs.nix'; sudo launchctl stop org.nixos.nix-daemon; sudo launchctl
start org.nixos.nix-daemon</strong>.</p>
</li>
</ul>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">buildPythonPackage</span></code> function now sets
<code class="docutils literal notranslate"><span class="pre">strictDeps</span> <span class="pre">=</span> <span class="pre">true</span></code> to help distinguish between native
and non-native dependencies in order to improve cross-compilation
compatibility. Note however that this may break user expressions.</p>
</li>
<li><dl class="first docutils">
<dt>The <code class="docutils literal notranslate"><span class="pre">buildPythonPackage</span></code> function now sets <a href="#id1"><span class="problematic" id="id2">``</span></a>LANG</dt>
<dd><p class="first last">= C.UTF-8`` to enable Unicode support. The</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">glibcLocales</span></code> package is no longer needed as a build
input.</p>
</li>
<li><p class="first">The Syncthing state and configuration data has been moved from
<code class="docutils literal notranslate"><span class="pre">services.syncthing.dataDir</span></code> to the newly defined
<code class="docutils literal notranslate"><span class="pre">services.syncthing.configDir</span></code>, which default to
<code class="docutils literal notranslate"><span class="pre">/var/lib/syncthing/.config/syncthing</span></code>. This change makes
possible to share synced directories using ACLs without Syncthing
resetting the permission on every start.</p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">ntp</span></code> module now has sane default restrictions. If
you’re relying on the previous defaults, which permitted all queries and
commands from all firewall-permitted sources, you can set
<code class="docutils literal notranslate"><span class="pre">services.ntp.restrictDefault</span></code> and
<code class="docutils literal notranslate"><span class="pre">services.ntp.restrictSource</span></code> to <code class="docutils literal notranslate"><span class="pre">[]</span></code>.</p>
</li>
<li><p class="first">Package <code class="docutils literal notranslate"><span class="pre">rabbitmq_server</span></code> is renamed to
<code class="docutils literal notranslate"><span class="pre">rabbitmq-server</span></code>.</p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">light</span></code> module no longer uses setuid binaries, but
udev rules. As a consequence users of that module have to belong to the
<code class="docutils literal notranslate"><span class="pre">video</span></code> group in order to use the executable (i.e.
<code class="docutils literal notranslate"><span class="pre">users.users.yourusername.extraGroups</span> <span class="pre">=</span> <span class="pre">\[&quot;video&quot;];</span></code>).</p>
</li>
<li><p class="first">Buildbot now supports Python 3 and its packages have been moved to
<code class="docutils literal notranslate"><span class="pre">pythonPackages</span></code>. The options
and
can be used to select
the Python 2 or 3 version of the package.</p>
</li>
<li><p class="first">Options
<code class="docutils literal notranslate"><span class="pre">services.znc.confOptions.networks.*name*.userName</span></code>
and
<code class="docutils literal notranslate"><span class="pre">services.znc.confOptions.networks.*name*.modulePackages</span></code>
were removed. They were never used for anything and can therefore safely
be removed.</p>
</li>
<li><p class="first">Package <code class="docutils literal notranslate"><span class="pre">wasm</span></code> has been renamed
<code class="docutils literal notranslate"><span class="pre">proglodyte-wasm</span></code>. The package <code class="docutils literal notranslate"><span class="pre">wasm</span></code>
will be pointed to <code class="docutils literal notranslate"><span class="pre">ocamlPackages.wasm</span></code> in 19.09, so make
sure to update your configuration if you want to keep
<code class="docutils literal notranslate"><span class="pre">proglodyte-wasm</span></code></p>
</li>
<li><p class="first">When the <code class="docutils literal notranslate"><span class="pre">nixpkgs.pkgs</span></code> option is set, NixOS will no
longer ignore the <code class="docutils literal notranslate"><span class="pre">nixpkgs.overlays</span></code> option. The old
behavior can be recovered by setting <code class="docutils literal notranslate"><span class="pre">nixpkgs.overlays</span> <span class="pre">=</span>
<span class="pre">lib.mkForce</span> <span class="pre">\[];</span></code>.</p>
</li>
<li><p class="first">OpenSMTPD has been upgraded to version 6.4.0p1. This release makes
backwards-incompatible changes to the configuration file format. See
<strong class="command">man smtpd.conf</strong> for more information on the new file
format.</p>
</li>
<li><p class="first">The versioned <code class="docutils literal notranslate"><span class="pre">postgresql</span></code> have been renamed to use
underscore number seperators. For example, <code class="docutils literal notranslate"><span class="pre">postgresql96</span></code>
has been renamed to <code class="docutils literal notranslate"><span class="pre">postgresql_9_6</span></code>.</p>
</li>
<li><p class="first">Package <code class="docutils literal notranslate"><span class="pre">consul-ui</span></code> and passthrough
<code class="docutils literal notranslate"><span class="pre">consul.ui</span></code> have been removed. The package
<code class="docutils literal notranslate"><span class="pre">consul</span></code> now uses upstream releases that vendor the UI
into the binary. See
<a class="reference external" href="https://github.com/NixOS/nixpkgs/pull/48714#issuecomment-433454834">#48714</a>
for details.</p>
</li>
<li><p class="first">Slurm introduces the new option
<code class="docutils literal notranslate"><span class="pre">services.slurm.stateSaveLocation</span></code>, which is now set to
<code class="docutils literal notranslate"><span class="pre">/var/spool/slurm</span></code> by default (instead of
<code class="docutils literal notranslate"><span class="pre">/var/spool</span></code>). Make sure to move all files to the new
directory or to set the option accordingly.</p>
<p>The slurmctld now runs as user <code class="docutils literal notranslate"><span class="pre">slurm</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">root</span></code>. If you want to keep slurmctld running as
<code class="docutils literal notranslate"><span class="pre">root</span></code>, set <code class="docutils literal notranslate"><span class="pre">services.slurm.user</span> <span class="pre">=</span>
<span class="pre">root</span></code>.</p>
<p>The options <code class="docutils literal notranslate"><span class="pre">services.slurm.nodeName</span></code> and
<code class="docutils literal notranslate"><span class="pre">services.slurm.partitionName</span></code> are now sets of strings to
correctly reflect that fact that each of these options can occour more
than once in the configuration.</p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">solr</span></code> package has been upgraded from 4.10.3 to 7.5.0
and has undergone some major changes. The <code class="docutils literal notranslate"><span class="pre">services.solr</span></code>
module has been updated to reflect these changes. Please review
<a class="reference external" href="http://lucene.apache.org/solr/">http://lucene.apache.org/solr/</a> carefully before upgrading.</p>
</li>
<li><p class="first">Package <code class="docutils literal notranslate"><span class="pre">ckb</span></code> is renamed to <code class="docutils literal notranslate"><span class="pre">ckb-next</span></code>,
and options <code class="docutils literal notranslate"><span class="pre">hardware.ckb.*</span></code> are renamed to
<code class="docutils literal notranslate"><span class="pre">hardware.ckb-next.*</span></code>.</p>
</li>
<li><p class="first">The option
<code class="docutils literal notranslate"><span class="pre">services.xserver.displayManager.job.logToFile</span></code> which was
previously set to <code class="docutils literal notranslate"><span class="pre">true</span></code> when using the display managers
<code class="docutils literal notranslate"><span class="pre">lightdm</span></code>, <code class="docutils literal notranslate"><span class="pre">sddm</span></code> or
<code class="docutils literal notranslate"><span class="pre">xpra</span></code> has been reset to the default value
(<code class="docutils literal notranslate"><span class="pre">false</span></code>).</p>
</li>
<li><p class="first">Network interface indiscriminate NixOS firewall options
(<code class="docutils literal notranslate"><span class="pre">networking.firewall.allow*</span></code>) are now preserved when
also setting interface specific rules such as
<code class="docutils literal notranslate"><span class="pre">networking.firewall.interfaces.en0.allow*</span></code>. These rules
continue to use the pseudo device “default”
(<code class="docutils literal notranslate"><span class="pre">networking.firewall.interfaces.default.*</span></code>), and
assigning to this pseudo device will override the
(<code class="docutils literal notranslate"><span class="pre">networking.firewall.allow*</span></code>) options.</p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">nscd</span></code> service now disables all caching of
<code class="docutils literal notranslate"><span class="pre">passwd</span></code> and <code class="docutils literal notranslate"><span class="pre">group</span></code> databases by
default. This was interferring with the correct functioning of the
<code class="docutils literal notranslate"><span class="pre">libnss_systemd.so</span></code> module which is used by
<code class="docutils literal notranslate"><span class="pre">systemd</span></code> to manage uids and usernames in the presence of
<code class="docutils literal notranslate"><span class="pre">DynamicUser=</span></code> in systemd services. This was already the
default behaviour in presence of <code class="docutils literal notranslate"><span class="pre">services.sssd.enable</span> <span class="pre">=</span>
<span class="pre">true</span></code> because nscd caching would interfere with
<code class="docutils literal notranslate"><span class="pre">sssd</span></code> in unpredictable ways as well. Because we’re using
nscd not for caching, but for convincing glibc to find NSS modules in the
nix store instead of an absolute path, we have decided to disable caching
globally now, as it’s usually not the behaviour the user wants and can
lead to surprising behaviour. Furthermore, negative caching of host
lookups is also disabled now by default. This should fix the issue of dns
lookups failing in the presence of an unreliable network.</p>
<p>If the old behaviour is desired, this can be restored by setting the
<code class="docutils literal notranslate"><span class="pre">services.nscd.config</span></code> option with the desired caching
parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">services</span><span class="o">.</span><span class="n">nscd</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span>
<span class="s1">&#39;&#39;</span>
<span class="n">server</span><span class="o">-</span><span class="n">user</span>             <span class="n">nscd</span>
<span class="n">threads</span>                 <span class="mi">1</span>
<span class="n">paranoia</span>                <span class="n">no</span>
<span class="n">debug</span><span class="o">-</span><span class="n">level</span>             <span class="mi">0</span>

<span class="n">enable</span><span class="o">-</span><span class="n">cache</span>            <span class="n">passwd</span>          <span class="n">yes</span>
<span class="n">positive</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span>   <span class="n">passwd</span>          <span class="mi">600</span>
<span class="n">negative</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span>   <span class="n">passwd</span>          <span class="mi">20</span>
<span class="n">suggested</span><span class="o">-</span><span class="n">size</span>          <span class="n">passwd</span>          <span class="mi">211</span>
<span class="n">check</span><span class="o">-</span><span class="n">files</span>             <span class="n">passwd</span>          <span class="n">yes</span>
<span class="n">persistent</span>              <span class="n">passwd</span>          <span class="n">no</span>
<span class="n">shared</span>                  <span class="n">passwd</span>          <span class="n">yes</span>

<span class="n">enable</span><span class="o">-</span><span class="n">cache</span>            <span class="n">group</span>           <span class="n">yes</span>
<span class="n">positive</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span>   <span class="n">group</span>           <span class="mi">3600</span>
<span class="n">negative</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span>   <span class="n">group</span>           <span class="mi">60</span>
<span class="n">suggested</span><span class="o">-</span><span class="n">size</span>          <span class="n">group</span>           <span class="mi">211</span>
<span class="n">check</span><span class="o">-</span><span class="n">files</span>             <span class="n">group</span>           <span class="n">yes</span>
<span class="n">persistent</span>              <span class="n">group</span>           <span class="n">no</span>
<span class="n">shared</span>                  <span class="n">group</span>           <span class="n">yes</span>

<span class="n">enable</span><span class="o">-</span><span class="n">cache</span>            <span class="n">hosts</span>           <span class="n">yes</span>
<span class="n">positive</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span>   <span class="n">hosts</span>           <span class="mi">600</span>
<span class="n">negative</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span>   <span class="n">hosts</span>           <span class="mi">5</span>
<span class="n">suggested</span><span class="o">-</span><span class="n">size</span>          <span class="n">hosts</span>           <span class="mi">211</span>
<span class="n">check</span><span class="o">-</span><span class="n">files</span>             <span class="n">hosts</span>           <span class="n">yes</span>
<span class="n">persistent</span>              <span class="n">hosts</span>           <span class="n">no</span>
<span class="n">shared</span>                  <span class="n">hosts</span>           <span class="n">yes</span>
<span class="s1">&#39;&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>See
<a class="reference external" href="https://github.com/NixOS/nixpkgs/pull/50316">#50316</a>
for details.</p>
</li>
<li><p class="first">GitLab Shell previously used the nix store paths for the
<code class="docutils literal notranslate"><span class="pre">gitlab-shell</span></code> command in its
<code class="docutils literal notranslate"><span class="pre">authorized_keys</span></code> file, which might stop working after
garbage collection. To circumvent that, we regenerated that file on each
startup. As <code class="docutils literal notranslate"><span class="pre">gitlab-shell</span></code> has now been changed to use
<code class="docutils literal notranslate"><span class="pre">/var/run/current-system/sw/bin/gitlab-shell</span></code>, this is
not necessary anymore, but there might be leftover lines with a nix store
path. Regenerate the <code class="docutils literal notranslate"><span class="pre">authorized_keys</span></code> file via
<strong class="command">sudo -u git -H gitlab-rake gitlab:shell:setup</strong> in that
case.</p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">pam_unix</span></code> account module is now loaded with its
control field set to <code class="docutils literal notranslate"><span class="pre">required</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">sufficient</span></code>, so that later PAM account modules that
might do more extensive checks are being executed. Previously, the whole
account module verification was exited prematurely in case a nss module
provided the account name to <code class="docutils literal notranslate"><span class="pre">pam_unix</span></code>. The LDAP and
SSSD NixOS modules already add their NSS modules when enabled. In case
your setup breaks due to some later PAM account module previosuly
shadowed, or failing NSS lookups, please file a bug. You can get back the
old behaviour by manually setting <code class="docutils literal notranslate"><span class="pre">security.pam.services.&lt;name?&gt;.text</span></code>.</p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">pam_unix</span></code> password module is now loaded with its
control field set to <code class="docutils literal notranslate"><span class="pre">sufficient</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">required</span></code>, so that password managed only by later PAM
password modules are being executed. Previously, for example, changing an
LDAP account’s password through PAM was not possible: the whole password
module verification was exited prematurely by <code class="docutils literal notranslate"><span class="pre">pam_unix</span></code>,
preventing <code class="docutils literal notranslate"><span class="pre">pam_ldap</span></code> to manage the password as it
should.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">fish</span></code> has been upgraded to 3.0. It comes with a number
of improvements and backwards incompatible changes. See the
<code class="docutils literal notranslate"><span class="pre">fish</span></code>
<a class="reference external" href="https://github.com/fish-shell/fish-shell/releases/tag/3.0.0">release
notes</a> for more information.</p>
</li>
<li><p class="first">The ibus-table input method has had a change in config format, which
causes all previous settings to be lost. See
<a class="reference external" href="https://github.com/mike-fabian/ibus-table/commit/f9195f877c5212fef0dfa446acb328c45ba5852b">this
commit message</a> for details.</p>
</li>
<li><p class="first">NixOS module system type <code class="docutils literal notranslate"><span class="pre">types.optionSet</span></code> and
<code class="docutils literal notranslate"><span class="pre">lib.mkOption</span></code> argument <code class="docutils literal notranslate"><span class="pre">options</span></code> are
deprecated. Use <code class="docutils literal notranslate"><span class="pre">types.submodule</span></code> instead.
(<a class="reference external" href="https://github.com/NixOS/nixpkgs/pull/54637">#54637</a>)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">matrix-synapse</span></code> has been updated to version 0.99. It
will <a class="reference external" href="https://github.com/matrix-org/synapse/pull/4509">no
longer generate a self-signed certificate on first launch</a> and will
be
<a class="reference external" href="https://matrix.org/blog/2019/02/05/synapse-0-99-0/">the
last version to accept self-signed certificates</a>. As such, it is now
recommended to use a proper certificate verified by a root CA (for example
Let’s Encrypt). The new <a class="reference external" href="None">manual
chapter on Matrix</a> contains a working example of using nginx as a
reverse proxy in front of <code class="docutils literal notranslate"><span class="pre">matrix-synapse</span></code>, using Let’s
Encrypt certificates.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">mailutils</span></code> now works by default when
<code class="docutils literal notranslate"><span class="pre">sendmail</span></code> is not in a setuid wrapper. As a consequence,
the <code class="docutils literal notranslate"><span class="pre">sendmailPath</span></code> argument, having lost its main use,
has been removed.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">graylog</span></code> has been upgraded from version 2.* to 3.*. Some
setups making use of extraConfig (especially those exposing Graylog via
reverse proxies) need to be updated as upstream removed/replaced some
settings. See
<a class="reference external" href="http://docs.graylog.org/en/3.0/pages/upgrade/graylog-3.0.html#simplified-http-interface-configuration">Upgrading
Graylog</a> for details.</p>
</li>
<li><p class="first">The option <code class="docutils literal notranslate"><span class="pre">users.ldap.bind.password</span></code> was renamed to <code class="docutils literal notranslate"><span class="pre">users.ldap.bind.passwordFile</span></code>,
and needs to be readable by the <code class="docutils literal notranslate"><span class="pre">nslcd</span></code> user.
Same applies to the new <code class="docutils literal notranslate"><span class="pre">users.ldap.daemon.rootpwmodpwFile</span></code> option.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">nodejs-6_x</span></code> is end-of-life.
<code class="docutils literal notranslate"><span class="pre">nodejs-6_x</span></code>, <code class="docutils literal notranslate"><span class="pre">nodejs-slim-6_x</span></code> and
<code class="docutils literal notranslate"><span class="pre">nodePackages_6_x</span></code> are removed.</p>
</li>
</ul>
</div>
<div class="section" id="other-notable-changes">
<span id="sec-release-19-03-notable-changes"></span><h1>Other Notable Changes<a class="headerlink" href="#other-notable-changes" title="Permalink to this headline">¶</a></h1>
<ul>
<li><p class="first">The module gained the option
which determines the used Matomo
version.</p>
<p>The Matomo module now also comes with the systemd service
<code class="docutils literal notranslate"><span class="pre">matomo-archive-processing.service</span></code> and a timer that
automatically triggers archive processing every hour. This means that you
can safely
<a class="reference external" href="https://matomo.org/docs/setup-auto-archiving/#disable-browser-triggers-for-matomo-archiving-and-limit-matomo-reports-to-updating-every-hour">disable browser triggers for Matomo archiving</a> at
<code class="docutils literal notranslate"><span class="pre">Administration</span> <span class="pre">&gt;</span> <span class="pre">System</span> <span class="pre">&gt;</span> <span class="pre">General</span> <span class="pre">Settings</span></code>.</p>
<p>Additionally, you can enable to
<a class="reference external" href="https://matomo.org/docs/privacy/#step-2-delete-old-visitors-logs">delete old visitor logs</a> at <code class="docutils literal notranslate"><span class="pre">Administration</span> <span class="pre">&gt;</span> <span class="pre">System</span> <span class="pre">&gt;</span>
<span class="pre">Privacy</span></code>, but make sure that you run <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">start</span>
<span class="pre">matomo-archive-processing.service</span></code> at least once without errors
if you have already collected data before, so that the reports get
archived before the source data gets deleted.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">composableDerivation</span></code> along with supporting library
functions has been removed.</p>
</li>
<li><p class="first">The deprecated <code class="docutils literal notranslate"><span class="pre">truecrypt</span></code> package has been removed and
<code class="docutils literal notranslate"><span class="pre">truecrypt</span></code> attribute is now an alias for
<code class="docutils literal notranslate"><span class="pre">veracrypt</span></code>. VeraCrypt is backward-compatible with
TrueCrypt volumes. Note that <code class="docutils literal notranslate"><span class="pre">cryptsetup</span></code> also supports
loading TrueCrypt volumes.</p>
</li>
<li><p class="first">The Kubernetes DNS addons, kube-dns, has been replaced with CoreDNS. This
change is made in accordance with Kubernetes making CoreDNS the official
default starting from
<a class="reference external" href="https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG-1.11.md#sig-cluster-lifecycle">Kubernetes
v1.11</a>. Please beware that upgrading DNS-addon on existing clusters
might induce minor downtime while the DNS-addon terminates and
re-initializes. Also note that the DNS-service now runs with 2 pod
replicas by default. The desired number of replicas can be configured
using: .</p>
</li>
<li><p class="first">The quassel-webserver package and module was removed from nixpkgs due to
the lack of maintainers.</p>
</li>
<li><p class="first">The manual gained a <a class="reference external" href="None">new chapter on
self-hosting matrix-synapse and
riot-web</a>, the most prevalent server and client
implementations for the
<a class="reference external" href="https://matrix.org/">Matrix</a> federated
communication network.</p>
</li>
<li><p class="first">The astah-community package was removed from nixpkgs due to it being
discontinued and the downloads not being available anymore.</p>
</li>
<li><p class="first">The httpd service now saves log files with a .log file extension by
default for easier integration with the logrotate service.</p>
</li>
<li><p class="first">The owncloud server packages and httpd subservice module were removed from
nixpkgs due to the lack of maintainers.</p>
</li>
<li><p class="first">It is possible now to uze ZRAM devices as general purpose ephemeral block
devices, not only as swap. Using more than 1 device as ZRAM swap is no
longer recommended, but is still possible by setting
<code class="docutils literal notranslate"><span class="pre">zramSwap.swapDevices</span></code> explicitly.</p>
<p>ZRAM algorithm can be changed now.</p>
<p>Changes to ZRAM algorithm are applied during <code class="docutils literal notranslate"><span class="pre">nixos-rebuild</span>
<span class="pre">switch</span></code>, so make sure you have enough swap space on disk to
survive ZRAM device rebuild. Alternatively, use <code class="docutils literal notranslate"><span class="pre">nixos-rebuild</span>
<span class="pre">boot;</span> <span class="pre">reboot</span></code>.</p>
</li>
<li><p class="first">Flat volumes are now disabled by default in
<code class="docutils literal notranslate"><span class="pre">hardware.pulseaudio</span></code>. This has been done to prevent
applications, which are unaware of this feature, setting their volumes to
100% on startup causing harm to your audio hardware and potentially your
ears.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">With this change application specific volumes are relative to the master
volume which can be adjusted independently, whereas before they were
absolute; meaning that in effect, it scaled the device-volume with the
volume of the loudest application.</p>
</div>
</li>
<li><p class="first">The
<a class="reference external" href="https://github.com/DanielAdolfsson/ndppd">ndppd</a>
module now supports <a class="reference external" href="None">all config
options</a> provided by the current upstream version as service
options. Additionally the <code class="docutils literal notranslate"><span class="pre">ndppd</span></code> package doesn’t contain
the systemd unit configuration from upstream anymore, the unit is
completely configured by the NixOS module now.</p>
</li>
<li><p class="first">New installs of NixOS will default to the Redmine 4.x series unless
otherwise specified in <code class="docutils literal notranslate"><span class="pre">services.redmine.package</span></code> while
existing installs of NixOS will default to the Redmine 3.x series.</p>
</li>
<li><p class="first">The <a class="reference external" href="None">Grafana module</a> now
supports declarative
<a class="reference external" href="http://docs.grafana.org/administration/provisioning/">datasource
and dashboard</a> provisioning.</p>
</li>
<li><p class="first">The use of insecure ports on kubernetes has been deprecated. Thus options:
<code class="docutils literal notranslate"><span class="pre">services.kubernetes.apiserver.port</span></code> and
<code class="docutils literal notranslate"><span class="pre">services.kubernetes.controllerManager.port</span></code> has been
renamed to <code class="docutils literal notranslate"><span class="pre">.insecurePort</span></code>, and default of both options
has changed to 0 (disabled).</p>
</li>
<li><p class="first">Note that the default value of
<code class="docutils literal notranslate"><span class="pre">services.kubernetes.apiserver.bindAddress</span></code> has changed
from 127.0.0.1 to 0.0.0.0, allowing the apiserver to be accessible from
outside the master node itself. If the apiserver insecurePort is enabled,
it is strongly recommended to only bind on the loopback interface. See:
<code class="docutils literal notranslate"><span class="pre">services.kubernetes.apiserver.insecurebindAddress</span></code>.</p>
</li>
<li><p class="first">The option
<code class="docutils literal notranslate"><span class="pre">services.kubernetes.apiserver.allowPrivileged</span></code> and
<code class="docutils literal notranslate"><span class="pre">services.kubernetes.kubelet.allowPrivileged</span></code> now
defaults to false. Disallowing privileged containers on the cluster.</p>
</li>
<li><p class="first">The kubernetes module does no longer add the kubernetes package to
<code class="docutils literal notranslate"><span class="pre">environment.systemPackages</span></code> implicitly.</p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">intel</span></code> driver has been removed from the default list
of <a class="reference external" href="None">X.org video
drivers</a>. The <code class="docutils literal notranslate"><span class="pre">modesetting</span></code> driver should take over
automatically, it is better maintained upstream and has less problems with
advanced X11 features. This can lead to a change in the output names used
by <code class="docutils literal notranslate"><span class="pre">xrandr</span></code>. Some performance regressions on some GPU
models might happen. Some OpenCL and VA-API applications might also break
(Beignet seems to provide OpenCL support with
<code class="docutils literal notranslate"><span class="pre">modesetting</span></code> driver, too). Kernel mode setting API does
not support backlight control, so <code class="docutils literal notranslate"><span class="pre">xbacklight</span></code> tool will
not work; backlight level can be controlled directly via
<code class="docutils literal notranslate"><span class="pre">/sys/</span></code> or with <code class="docutils literal notranslate"><span class="pre">brightnessctl</span></code>. Users
who need this functionality more than multi-output XRandR are advised to
add `intel` to `videoDrivers` and report an issue (or provide additional
details in an existing one)</p>
</li>
<li><p class="first">Openmpi has been updated to version 4.0.0, which removes some deprecated
MPI-1 symbols. This may break some older applications that still rely on
those symbols. An upgrade guide can be found
<a class="reference external" href="https://www.open-mpi.org/faq/?category=mpi-removed">here</a>.</p>
<p>The nginx package now relies on OpenSSL 1.1 and supports TLS 1.3 by
default. You can set the protocols used by the nginx service using
<a class="reference internal" href="../generated/options-db.xml.html#opt-services-nginx-sslprotocols"><span class="std std-ref">services.nginx.sslProtocols</span></a>.</p>
</li>
<li><p class="first">A new subcommand <strong class="command">nixos-rebuild edit</strong> was added.</p>
</li>
</ul>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">NixOS Manual</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../preface.xml.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.xml.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/configuration.xml.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration/running.xml.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/development.xml.html">Development</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../generated/options-db.xml.html">Configuration Options</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;1970, lewo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/release-notes/rl-1903.xml.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>